<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>ç¬¬ä¸€ç«   ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç» | BLOG</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://perfectqing.github.io/blogs/favicon.ico?v=1626771437070">
<link rel="stylesheet" href="https://perfectqing.github.io/blogs/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ğŸ‘  ç¬¬ä¸€ç«   ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç»
âœï¸  æœ¬è®²ç›®æ ‡ï¼šå­¦ä¼šç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹ï¼Œä½¿ç”¨åŸºäºTF2åŸç”Ÿä»£ç æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œè®­ç»ƒæ¨¡å‹ã€‚

ç¬¬ä¸€ç«   ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç»
æœ¬è®²ç›®æ ‡ï¼šå­¦ä¼šç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹ï¼Œä½¿ç”¨åŸºäºTF2åŸç”Ÿä»£ç æ­å»ºä½ çš„ç¬¬ä¸€..." />
    <meta name="keywords" content="TensorFlow ç¬”è®°" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://perfectqing.github.io/blogs">
        <img src="https://perfectqing.github.io/blogs/images/avatar.png?v=1626771437070" class="site-logo">
        <h1 class="site-title">BLOG</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      Carry on what you want...
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> Copyright Â© AlsoRan | <a class="rss" href="https://perfectqing.github.io/blogs/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">ç¬¬ä¸€ç«   ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç»</h2>
            <div class="post-date">2021-07-12</div>
            
              <div class="feature-container" style="background-image: url('https://perfectqing.github.io/blogs/post-images/hello-gridea.png')">
              </div>
            
            <div class="post-content" v-pre>
              <p>ğŸ‘  ç¬¬ä¸€ç«   ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç»<br>
âœï¸  æœ¬è®²ç›®æ ‡ï¼šå­¦ä¼šç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹ï¼Œä½¿ç”¨åŸºäºTF2åŸç”Ÿä»£ç æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œè®­ç»ƒæ¨¡å‹ã€‚</p>
<!-- more -->
<h2 id="ç¬¬ä¸€ç« -ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç»">ç¬¬ä¸€ç«   ç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹åŠä»‹ç»</h2>
<p>æœ¬è®²ç›®æ ‡ï¼šå­¦ä¼šç¥ç»ç½‘ç»œè®¡ç®—è¿‡ç¨‹ï¼Œä½¿ç”¨åŸºäºTF2åŸç”Ÿä»£ç æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œè®­ç»ƒæ¨¡å‹ã€‚</p>
<p>äººå·¥æ™ºèƒ½ï¼šè®©æœºå™¨å…·å¤‡äººçš„æ€ç»´å’Œæ„è¯†ã€‚</p>
<h3 id="11-äººå·¥æ™ºèƒ½ä¸‰å­¦æ´¾">1.1 äººå·¥æ™ºèƒ½ä¸‰å­¦æ´¾</h3>
<ul>
<li>è¡Œä¸ºä¸»ä¹‰ï¼šåŸºäºæ§åˆ¶è®ºï¼Œæ„å»ºæ„ŸçŸ¥-åŠ¨ä½œæ§åˆ¶ç³»ç»Ÿã€‚ï¼ˆæ§åˆ¶è®ºï¼Œå¦‚å¹³è¡¡ã€è¡Œèµ°ã€é¿éšœç­‰è‡ªé€‚åº”æ§åˆ¶ç³»ç»Ÿï¼‰</li>
<li>ç¬¦å·ä¸»ä¹‰ï¼šåŸºäºç®—æ•°é€»è¾‘è¡¨è¾¾å¼ï¼Œæ±‚è§£é—®é¢˜æ—¶å…ˆæŠŠé—®é¢˜æè¿°ä¸ºè¡¨è¾¾å¼ï¼Œå†æ±‚è§£è¡¨è¾¾å¼ã€‚ï¼ˆå¯ç”¨å…¬å¼æè¿°ã€å®ç°ç†æ€§æ€ç»´ï¼Œå¦‚ä¸“å®¶ç³»ç³»ç»Ÿï¼‰</li>
<li>è¿æ¥ä¸»ä¹‰ï¼šä»¿ç”Ÿå­¦ï¼Œæ¨¡ä»¿ç¥ç»å…ƒè¿æ¥å…³ç³»ã€‚ï¼ˆä»¿è„‘ç¥ç»å…ƒè¿æ¥ï¼Œå®ç°æ„Ÿæ€§æ€ç»´ï¼Œå¦‚ç¥ç»ç½‘ç»œï¼‰</li>
</ul>
<h3 id="12-ç¥ç»ç½‘ç»œçš„è®¾è®¡è¿‡ç¨‹">1.2 ç¥ç»ç½‘ç»œçš„è®¾è®¡è¿‡ç¨‹</h3>
<ol>
<li>
<h4 id="é¸¢å°¾èŠ±åˆ†ç±»iris">é¸¢å°¾èŠ±åˆ†ç±»ï¼ˆIrisï¼‰</h4>
<pre><code>0  ç‹—å°¾è‰é¸¢å°¾
1  æ‚è‰²é¸¢å°¾
2  ä½›å‰å°¼äºšé¸¢å°¾
</code></pre>
<ul>
<li>ç®€åŒ–æ¨¡å‹ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><mo>Ã—</mo><mi>w</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y=x\times w+ b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></li>
<li>å‡æ–¹è¯¯å·®ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><msub><mi>y</mi><mi mathvariant="normal">_</mi></msub><mo>)</mo><mo>=</mo><mfrac><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><mo>(</mo><mi>y</mi><mo>âˆ’</mo><msub><mi>y</mi><mi mathvariant="normal">_</mi></msub><msup><mo>)</mo><mn>2</mn></msup></mrow><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">MSE(y,y_\_)=\frac{\sum_{k=0}^n(y-y_\_)^2}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.117em;vertical-align:-0.367em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.065608em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight" style="margin-right:0.02778em;">_</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.367em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53402em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.18902em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5651em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mbin mtight">âˆ’</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.05688571428571432em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight" style="margin-right:0.02778em;">_</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.36442857142857144em;"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
<li>
<h4 id="ç”¨ç¥ç»ç½‘ç»œå®ç°é¸¢å°¾èŠ±åˆ†ç±»æ¢¯åº¦ä¸‹é™">ç”¨ç¥ç»ç½‘ç»œå®ç°é¸¢å°¾èŠ±åˆ†ç±»ï¼šæ¢¯åº¦ä¸‹é™</h4>
<ul>
<li>ç›®çš„ï¼šæ‰¾åˆ°ä¸€ç»„å‚æ•°wå’Œbï¼Œä½¿å¾—æŸå¤±å‡½æ•°æœ€å°ã€‚</li>
<li>æ¢¯åº¦ï¼šå‡½æ•°å¯¹å„å‚æ•°æ±‚åå¯¼åçš„å‘é‡ã€‚å‡½æ•°æ¢¯åº¦ä¸‹é™æ–¹å‘æ˜¯å‡½æ•°å‡å°æ–¹å‘ã€‚</li>
<li>æ¢¯åº¦ä¸‹é™æ³•ï¼šæ²¿æŸå¤±å‡½æ•°æ¢¯åº¦ä¸‹é™çš„æ–¹å‘ï¼Œå¯»æ‰¾æŸå¤±å‡½æ•°çš„æœ€å°å€¼ï¼Œå¾—åˆ°æœ€ä¼˜å‚æ•°çš„æ–¹æ³•ã€‚</li>
</ul>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \part at position 26: â€¦t - lr * \frac{\Ì²pÌ²aÌ²rÌ²tÌ² Ì²loss}{\part w_tâ€¦'>w_{t+1}=w_t - lr * \frac{\part loss}{\part w_t}\\
b_{t+1} = b_t -  lr * \frac{\part loss}{\part b_t}\\
w_{t+1} * x + b_{t+1} = y
</p>
<ul>
<li>å­¦ä¹ ç‡ï¼ˆlearning rateï¼Œ lrï¼‰ï¼šå½“å­¦ä¹ ç‡è®¾ç½®çš„è¿‡å°æ—¶ï¼Œæ”¶æ•›è¿‡ç¨‹å°†å˜å¾—ååˆ†ç¼“æ…¢ã€‚è€Œå½“å­¦ä¹ ç‡è®¾ç½®çš„è¿‡å¤§æ—¶ï¼Œæ¢¯åº¦å¯èƒ½ä¼šåœ¨æœ€å°å€¼é™„è¿‘æ¥å›éœ‡è¡ï¼Œç”šè‡³å¯èƒ½æ— æ³•æ”¶æ•›ã€‚</li>
</ul>
</li>
<li>
<h4 id="ç”¨ç¥ç»ç½‘ç»œå®ç°é¸¢å°¾èŠ±åˆ†ç±»åå‘ä¼ æ’­">ç”¨ç¥ç»ç½‘ç»œå®ç°é¸¢å°¾èŠ±åˆ†ç±»ï¼šåå‘ä¼ æ’­</h4>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \part at position 26: â€¦t - lr * \frac{\Ì²pÌ²aÌ²rÌ²tÌ² Ì²loss}{\part w_tâ€¦'>w_{t+1}=w_t - lr * \frac{\part loss}{\part w_t}
</p>
<ul>
<li>åå‘ä¼ æ’­ï¼šä»åå‘å‰ï¼Œé€å±‚æ±‚æŸå¤±å‡½æ•°å¯¹æ¯å±‚ç¥ç»å…ƒå‚æ•°çš„åå¯¼æ•°ï¼Œè¿­ä»£æ›´æ–°æ‰€æœ‰å‚æ•°ã€‚</li>
<li>egï¼šæŸå¤±å‡½æ•° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>(</mo><mi>w</mi><mo>+</mo><mn>1</mn><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">loss=(w+1)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>,  <span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \part at position 7: \frac{\Ì²pÌ²aÌ²rÌ²tÌ² Ì²loss}{\part w}=â€¦'>\frac{\part loss}{\part w}=2w+2</span></li>
</ul>
<pre><code>å‚æ•°åˆå§‹åŒ–ä¸º5ï¼Œå­¦ä¹ ç‡ä¸º0.2ï¼Œåˆ™
1æ¬¡  å‚æ•°w:5      5-0.2*(2*5+2)=2.6
2æ¬¡  å‚æ•°w:2.6    2.6-0.2*(2*2.6+2)=1.16
3æ¬¡  å‚æ•°w:1.16   1.16-0.2*(2*1.16+2)=0.296
4æ¬¡  å‚æ•°w:0.296
......
</code></pre>
<ul>
<li>Code  p13_backpropagation.py</li>
</ul>
<pre><code class="language-python">import tensorflow as tf

w = tf.Variable(tf.constant(5, dtype=tf.float32))
lr = 0.2
epoch = 40

for epoch in range(epoch):  # for epoch å®šä¹‰é¡¶å±‚å¾ªç¯ï¼Œè¡¨ç¤ºå¯¹æ•°æ®é›†å¾ªç¯epochæ¬¡ï¼Œæ­¤ä¾‹æ•°æ®é›†æ•°æ®ä»…æœ‰1ä¸ªw,åˆå§‹åŒ–æ—¶å€™constantèµ‹å€¼ä¸º5ï¼Œå¾ªç¯40æ¬¡è¿­ä»£ã€‚
    with tf.GradientTape() as tape:  # withç»“æ„åˆ°gradsæ¡†èµ·äº†æ¢¯åº¦çš„è®¡ç®—è¿‡ç¨‹ã€‚
        loss = tf.square(w + 1)
    grads = tape.gradient(loss, w)  # .gradientå‡½æ•°å‘ŠçŸ¥è°å¯¹è°æ±‚å¯¼

    w.assign_sub(lr * grads)  # .assign_sub å¯¹å˜é‡åšè‡ªå‡ å³ï¼šw -= lr*grads å³ w = w - lr*grads
    print(&quot;After %s epoch,w is %f,loss is %f&quot; % (epoch, w.numpy(), loss))

# lråˆå§‹å€¼ï¼š0.2   è¯·è‡ªæ”¹å­¦ä¹ ç‡  0.001  0.999 çœ‹æ”¶æ•›è¿‡ç¨‹
# æœ€ç»ˆç›®çš„ï¼šæ‰¾åˆ° loss æœ€å° å³ w = -1 çš„æœ€ä¼˜å‚æ•°w

</code></pre>
</li>
</ol>
<h3 id="13-å¼ é‡ç”Ÿæˆ">1.3 å¼ é‡ç”Ÿæˆ</h3>
<ul>
<li>
<p>**å¼ é‡ï¼ˆTensorï¼‰ï¼š**å¤šç»´æ•°ç»„ï¼ˆåˆ—è¡¨ï¼‰  é˜¶ï¼šå¼ é‡çš„ç»´æ•°</p>
<table>
<thead>
<tr>
<th style="text-align:center">ç»´æ•°</th>
<th style="text-align:center">é˜¶</th>
<th style="text-align:left">åå­—</th>
<th>ä¾‹å­</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0-D</td>
<td style="text-align:center">0</td>
<td style="text-align:left">æ ‡é‡ scalar</td>
<td>s=1 2 3</td>
</tr>
<tr>
<td style="text-align:center">1-D</td>
<td style="text-align:center">1</td>
<td style="text-align:left">å‘é‡ vector</td>
<td>v=[1, 2, 3]</td>
</tr>
<tr>
<td style="text-align:center">2-D</td>
<td style="text-align:center">2</td>
<td style="text-align:left">çŸ©é˜µ matrix</td>
<td>m=[[1, 2, 3], [4, 5, 6], [7, 8, 9]]</td>
</tr>
<tr>
<td style="text-align:center">n-D</td>
<td style="text-align:center">n</td>
<td style="text-align:left">å¼ é‡ tensor</td>
<td>t=[[[    nä¸ª</td>
</tr>
</tbody>
</table>
<p>å¼ é‡å¯ä»¥è¡¨ç¤º0é˜¶åˆ°né˜¶æ•°ç»„ï¼ˆåˆ—è¡¨ï¼‰</p>
</li>
<li>
<p>æ•°æ®ç±»å‹</p>
<ul>
<li>
<p>tf.int, tf.float ......</p>
<p>tf.int32, tf.float32, tf.float64</p>
</li>
<li>
<p>tf.bool</p>
<p>tf.constant([True, False])</p>
</li>
<li>
<p>tf.string</p>
<p>tf.constant(&quot;hello, world!&quot;)</p>
</li>
</ul>
</li>
<li>
<p>å¦‚ä½•åˆ›å»ºä¸€ä¸ªTensor</p>
<p>åˆ›å»ºä¸€ä¸ªå¼ é‡<br>
tf.constant(å¼ é‡å†…å®¹, dtype=æ•°æ®ç±»å‹(å¯é€‰))</p>
<pre><code class="language-python">import tensorflow as tf

a = tf.constant([1, 5], dtype=tf.int64)
print(a)
print(a.dtype)
print(a.shape)

# è¿è¡Œç»“æœ
# tf.Tensor([1 5], shape=(2,), dtype=int64)
# &lt;dtype: 'int64'&gt;
# (2,)  ä¸€ç»´å¼ é‡ï¼Œå«æœ‰ä¸¤ä¸ªå…ƒç´ 
</code></pre>
</li>
<li>
<p>å°†numpyçš„æ•°æ®ç±»å‹è½¬æ¢ä¸ºTensoræ•°æ®ç±»å‹</p>
<p>tf.convert_to_tensor(æ•°æ®å, dtype=æ•°æ®ç±»å‹(å¯é€‰))</p>
<pre><code class="language-python">import tensorflow as tf
import numpy as np
a = np.arange(0, 5)
b = tf.convert_to_tensor(a, dtype=tf.int64)
print(a)
print(b)

# è¿è¡Œç»“æœ
# [0 1 2 3 4]
# tf.Tensor([0 1 2 3 4], shape=(5,), dtype=int64)
</code></pre>
</li>
<li>
<p>åˆ›å»ºå…¨ä¸º0çš„å¼ é‡</p>
<p>tf.zeros(ç»´åº¦)</p>
</li>
<li>
<p>åˆ›å»ºå…¨ä¸º1çš„å¼ é‡</p>
<p>tf.ones(ç»´åº¦)</p>
</li>
<li>
<p>åˆ›å»ºå…¨ä¸ºæŒ‡å®šç»´åº¦çš„å¼ é‡</p>
<p>tf.fill(ç»´åº¦, æŒ‡å®šå€¼)</p>
<p>ç»´åº¦ï¼šä¸€ç»´ç›´æ¥å†™ä¸ªæ•°ï¼ŒäºŒç»´ç”¨[è¡Œ, åˆ—]ï¼Œå¤šä¸ºç”¨[n, m, j, k ......]</p>
<pre><code class="language-python">import tensorflow as tf

a = tf.zeros([2, 3])
b = tf.ones(4)
c = tf.fill([2, 2], 9)
print(a)
print(b)
print(c)

# è¿è¡Œç»“æœ
# tf.Tensor(
# [[0. 0. 0.]
#  [0. 0. 0.]], shape=(2, 3), dtype=float32)
# tf.Tensor([1. 1. 1. 1.], shape=(4,), dtype=float32)
# tf.Tensor(
# [[9 9]
#  [9 9]], shape=(2, 2), dtype=int32)
</code></pre>
</li>
<li>
<p>ç”Ÿæˆæ­£æ€åˆ†å¸ƒçš„éšæœºæ•°, é»˜è®¤å‡å€¼ä¸º0, æ ‡å‡†å·®ä¸º1</p>
<p>tf.random.normal(ç»´åº¦, mean=å‡å€¼, stddev=æ ‡å‡†å·®)</p>
</li>
<li>
<p>ç”Ÿæˆæˆªæ–­å¼æ­£æ€åˆ†å¸ƒçš„éšæœºæ•°</p>
<p>tf.random.truncated_normal(ç»´åº¦, mean=å‡å€¼, stddev=æ ‡å‡†å·®)</p>
<p>åœ¨tf.truncated_normalä¸­å¦‚æœéšæœºç”Ÿæˆæ•°æ®çš„å–å€¼åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>Î¼</mi><mo>âˆ’</mo><mn>2</mn><mi>Î´</mi><mo separator="true">,</mo><mi>Î¼</mi><mo>+</mo><mn>2</mn><mi>Î´</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(\mu-2\delta,\mu+2\delta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">Î¼</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03785em;">Î´</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">Î¼</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03785em;">Î´</span><span class="mclose">)</span></span></span></span> ä¹‹å¤–åˆ™é‡æ–°è¿›è¡Œç”Ÿæˆï¼Œä¿è¯äº†ç”Ÿæˆå€¼åœ¨å‡å€¼é™„è¿‘ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Î¼</span></span></span></span>ï¼šå‡å€¼ï¼Œ  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î´</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">Î´</span></span></span></span>ï¼šæ ‡å‡†å·®<br>
æ ‡å‡†å·®è®¡ç®—å…¬å¼ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î´</mi><mo>=</mo><msqrt><mfrac><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><mover accent="true"><mi>x</mi><mo>Ë‰</mo></mover><mo>)</mo></mrow><mi>n</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">\delta=\sqrt{\frac{\sum_{i=1}^n (x_i-\bar x)}{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">Î´</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.4974965em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3425035em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.060007em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5350070000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7046857142857144em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathdefault mtight">x</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mtight">Ë‰</span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3025035em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,
572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,
-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39
c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60
s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,
-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10z
M1001 80H400000v40H1013z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4974965em;"><span></span></span></span></span></span></span></span></span></p>
<pre><code class="language-python">import tensorflow as tf

d = tf.random.normal([2, 2], mean=0.5, stddev=1)
print(&quot;d:&quot;, d)
e = tf.random.truncated_normal([2, 2], mean=0.5, stddev=1)
print(&quot;e:&quot;, e)

# è¿è¡Œç»“æœ
# d: tf.Tensor(
# [[ 1.9877443  -1.2797751 ]
#  [ 1.6146473   0.39082623]], shape=(2, 2), dtype=float32)
# e: tf.Tensor(
# [[ 1.3543694   1.0639844 ]
#  [-0.9956173  -0.16789067]], shape=(2, 2), dtype=float32)
</code></pre>
</li>
<li>
<p>ç”Ÿæˆå‡åŒ€åˆ†å¸ƒéšæœºæ•° [minval, maxval]</p>
<p>tf.random.uniform(ç»´åº¦, minval=æœ€å°å€¼, maxval=æœ€å¤§å€¼)</p>
<pre><code class="language-python">import tensorflow as tf

f = tf.random.uniform([2, 2], minval=0, maxval=1)
print(&quot;f:&quot;, f)

# è¿è¡Œç»“æœ
# f: tf.Tensor(
# [[0.78154075 0.5844718 ]
#  [0.6193285  0.62899697]], shape=(2, 2), dtype=float32)
</code></pre>
</li>
</ul>
<h3 id="14-å¸¸ç”¨å‡½æ•°">1.4 å¸¸ç”¨å‡½æ•°</h3>
<ul>
<li>
<p>å¼ºåˆ¶tensorè½¬æ¢ä¸ºè¯¥æ•°æ®ç±»å‹</p>
<p>tf.cast(å¼ é‡å, dtype=æ•°æ®ç±»å‹)</p>
</li>
<li>
<p>è®¡ç®—å¼ é‡ç»´åº¦ä¸Šå…ƒç´ çš„æœ€å°å€¼</p>
<p>tf.reduce_min(å¼ é‡å)</p>
</li>
<li>
<p>è®¡ç®—å¼ é‡ç»´åº¦ä¸Šçš„æœ€å¤§å€¼</p>
<p>tf.reduce_max(å¼ é‡å)</p>
</li>
</ul>
<pre><code class="language-python">import tensorflow as tf

x1 = tf.constant([1., 2., 3.], dtype=tf.float64)
print(&quot;x1:&quot;, x1)
x2 = tf.cast(x1, tf.int32)
print(&quot;x2&quot;, x2)
print(&quot;minimum of x2ï¼š&quot;, tf.reduce_min(x2))
print(&quot;maxmum of x2:&quot;, tf.reduce_max(x2))

# è¿è¡Œç»“æœ
# x1: tf.Tensor([1. 2. 3.], shape=(3,), dtype=float64)
# x2 tf.Tensor([1 2 3], shape=(3,), dtype=int32)
# minimum of x2ï¼š tf.Tensor(1, shape=(), dtype=int32)
# maxmum of x2: tf.Tensor(3, shape=(), dtype=int32)
</code></pre>
<ul>
<li>
<p>ç†è§£axis</p>
<p>åœ¨ä¸€ä¸ªäºŒä½å¼ é‡æˆ–è€…æ•°ç»„ä¸­ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´axisç­‰äº0æˆ–1æ§åˆ¶æ‰§è¡Œç»´åº¦ã€‚</p>
<ul>
<li>axis=0ä»£è¡¨è·¨è¡Œï¼ˆç»åº¦ï¼Œdownï¼‰ï¼Œè€Œaxis=1ä»£è¡¨è·¨åˆ—ï¼ˆçº¬åº¦ï¼Œacrossï¼‰</li>
<li>å¦‚æœä¸æŒ‡å®šaxisï¼Œåˆ™æ‰€æœ‰å…ƒç´ å‚ä¸è®¡ç®—</li>
</ul>
</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://images.cnblogs.com/cnblogs_com/ache/1998711/o_2107111240321-1.png" alt="image-20210710134643046" loading="lazy"></figure>
<ul>
<li>
<p>è®¡ç®—å¼ é‡æ²¿æŒ‡å®šç»´åº¦çš„å¹³å‡å€¼</p>
<p>tf.reduce_mean(å¼ é‡å, axis=æ“ä½œè½´)</p>
</li>
<li>
<p>è®¡ç®—å¼ é‡æ²¿ç€æŒ‡å®šç»´åº¦çš„å’Œ</p>
<p>tf.reduce_sum(å¼ é‡å, axis=æ“ä½œè½´)</p>
</li>
</ul>
<pre><code class="language-python">import tensorflow as tf

x = tf.constant([[1, 2, 3], [2, 2, 3]])
print(&quot;x:&quot;, x)
print(&quot;mean of x:&quot;, tf.reduce_mean(x))  # æ±‚xä¸­æ‰€æœ‰æ•°çš„å‡å€¼
print(&quot;mean of x by rows:&quot;, tf.reduce_mean(x, axis=0))  # æ±‚xä¸­æ¯ä¸€è¡Œæ•°çš„å‡å€¼
print(&quot;sum of x:&quot;, tf.reduce_sum(x, axis=1))  # æ±‚æ¯ä¸€è¡Œçš„å’Œ

# è¿è¡Œç»“æœ
# x: tf.Tensor(
# [[1 2 3]
#  [2 2 3]], shape=(2, 3), dtype=int32)
# mean of x: tf.Tensor(2, shape=(), dtype=int32)
# mean of x by rows: tf.Tensor([1 2 3], shape=(3,), dtype=int32)
# sum of x: tf.Tensor([6 7], shape=(2,), dtype=int32)
</code></pre>
<ul>
<li>
<p>tf.Variable</p>
<p>tf.Variable() å°†å˜é‡æ ‡è®°ä¸ºâ€œå¯è®­ç»ƒâ€ï¼Œ<strong>è¢«æ ‡è®°çš„å˜é‡ä¼šåœ¨åå‘ä¼ æ’­ä¸­è®°å½•æ¢¯åº¦ä¿¡æ¯</strong>ã€‚ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œå¸¸ç”¨è¯¥å‡½æ•°æ ‡è®°å¾…è®­ç»ƒå‚æ•°ã€‚<br>
tf.Variable(åˆå§‹å€¼)<br>
w = tf.Variable(tf.random.normal([2, 2], mean=0, stddev=1))</p>
</li>
<li>
<p>TensorFlowä¸­çš„æ•°å­¦è¿ç®—</p>
<ul>
<li>
<p><strong>å¯¹åº”å…ƒç´ </strong>çš„å››åˆ™è¿ç®—ï¼štf.add, tf.subtract, tf.multiply, tf.divide</p>
<p>tf.add(å¼ é‡1, å¼ é‡2)</p>
<pre><code class="language-python">import tensorflow as tf

a = tf.ones([1, 3])
b = tf.fill([1, 3], 3.)
print(&quot;a:&quot;, a)
print(&quot;b:&quot;, b)
print(&quot;a+b:&quot;, tf.add(a, b))
print(&quot;a-b:&quot;, tf.subtract(a, b))
print(&quot;a*b:&quot;, tf.multiply(a, b))
print(&quot;b/a:&quot;, tf.divide(b, a))

# è¿è¡Œç»“æœ
# a: tf.Tensor([[1. 1. 1.]], shape=(1, 3), dtype=float32)
# b: tf.Tensor([[3. 3. 3.]], shape=(1, 3), dtype=float32)
# a+b: tf.Tensor([[4. 4. 4.]], shape=(1, 3), dtype=float32)
# a-b: tf.Tensor([[-2. -2. -2.]], shape=(1, 3), dtype=float32)
# a*b: tf.Tensor([[3. 3. 3.]], shape=(1, 3), dtype=float32)
# b/a: tf.Tensor([[3. 3. 3.]], shape=(1, 3), dtype=float32)
</code></pre>
</li>
<li>
<p>å¹³æ–¹ã€æ¬¡æ–¹ä¸å¼€æ–¹ï¼štf.square, tf.pow, tf.sqrt</p>
<p>tf.square(å¼ é‡å)  # è®¡ç®—æŸä¸ªå¼ é‡çš„å¹³æ–¹<br>
tf.pow(å¼ é‡å, næ¬¡æ–¹æ•°)  # è®¡ç®—æŸä¸ªå¼ é‡çš„næ¬¡æ–¹<br>
tf.sqrt(å¼ é‡å)  # è®¡ç®—æŸä¸ªå¼ é‡çš„å¼€æ–¹</p>
<pre><code class="language-python">import tensorflow as tf

a = tf.fill([1, 2], 3.)
print(&quot;a:&quot;, a)
print(&quot;açš„å¹³æ–¹:&quot;, tf.pow(a, 3))
print(&quot;açš„å¹³æ–¹:&quot;, tf.square(a))
print(&quot;açš„å¼€æ–¹:&quot;, tf.sqrt(a))

# è¿è¡Œç»“æœ
# a: tf.Tensor([[3. 3.]], shape=(1, 2), dtype=float32)
# açš„å¹³æ–¹: tf.Tensor([[27. 27.]], shape=(1, 2), dtype=float32)
# açš„å¹³æ–¹: tf.Tensor([[9. 9.]], shape=(1, 2), dtype=float32)
# açš„å¼€æ–¹: tf.Tensor([[1.7320508 1.7320508]], shape=(1, 2), dtype=float32)
</code></pre>
</li>
<li>
<p>çŸ©é˜µä¹˜ï¼štf.matmul</p>
<p>tf.marmul(çŸ©é˜µ1, çŸ©é˜µ2)  # å®ç°ä¸¤ä¸ªçŸ©é˜µçš„ç›¸ä¹˜</p>
<pre><code class="language-python">import tensorflow as tf

a = tf.ones([3, 2])
b = tf.fill([2, 3], 3.)
print(&quot;a:&quot;, a)
print(&quot;b:&quot;, b)
print(&quot;a*b:&quot;, tf.matmul(a, b))

# è¿è¡Œç»“æœ
# a: tf.Tensor(
# [[1. 1.]
#  [1. 1.]
#  [1. 1.]], shape=(3, 2), dtype=float32)
# b: tf.Tensor(
# [[3. 3. 3.]
#  [3. 3. 3.]], shape=(2, 3), dtype=float32)
# a*b: tf.Tensor(
# [[6. 6. 6.]
#  [6. 6. 6.]
#  [6. 6. 6.]], shape=(3, 3), dtype=float32)
</code></pre>
</li>
</ul>
</li>
<li>
<p>tf.Dataset.from_tensor_slices</p>
<p>å°†åˆ‡åˆ†ä¼ å…¥å¼ é‡çš„ç¬¬ä¸€ç»´åº¦ï¼Œç”Ÿæˆè¾“å…¥ç‰¹å¾/æ ‡ç­¾å¯¹ï¼Œæ„å»ºæ•°æ®é›†data = tf.data.Dataset.from_tensor_slices((è¾“å…¥ç‰¹å¾, æ ‡ç­¾))<br>
(Numpyå’ŒTensoræ ¼å¼éƒ½å¯ç”¨è¯¥è¯­å¥è¯»å…¥æ•°æ®)</p>
<pre><code class="language-python">import tensorflow as tf

features = tf.constant([12, 23, 10, 17])
labels = tf.constant([0, 1, 1, 0])
dataset = tf.data.Dataset.from_tensor_slices((features, labels))
for element in dataset:
    print(element)

# è¿è¡Œç»“æœ
# (&lt;tf.Tensor: shape=(), dtype=int32, numpy=12&gt;, &lt;tf.Tensor: shape=(), dtype=int32, numpy=0&gt;)
# (&lt;tf.Tensor: shape=(), dtype=int32, numpy=23&gt;, &lt;tf.Tensor: shape=(), dtype=int32, numpy=1&gt;)
# (&lt;tf.Tensor: shape=(), dtype=int32, numpy=10&gt;, &lt;tf.Tensor: shape=(), dtype=int32, numpy=1&gt;)
# (&lt;tf.Tensor: shape=(), dtype=int32, numpy=17&gt;, &lt;tf.Tensor: shape=(), dtype=int32, numpy=0&gt;)
</code></pre>
</li>
<li>
<p>tf.GradientTape</p>
<p>withç»“æ„è®°å½•è®¡ç®—è¿‡ç¨‹ï¼Œgradientæ±‚å‡ºå¼ é‡çš„æ¢¯åº¦</p>
<pre><code class="language-python">with tf.GradientTape() as tape:
	è‹¥å¹²ä¸ªè®¡ç®—è¿‡ç¨‹
grad = tape.gradient(å‡½æ•°, å¯¹è°æ±‚å¯¼)
</code></pre>
<pre><code class="language-python">import tensorflow as tf

with tf.GradientTape() as tape:
    x = tf.Variable(tf.constant(3.0))
    y = tf.pow(x, 2)
grad = tape.gradient(y, x)
print(grad)

# è¿è¡Œç»“æœ
# tf.Tensor(6.0, shape=(), dtype=float32)
</code></pre>
</li>
<li>
<p>enumerate</p>
<p>enumerateæ˜¯pythonçš„å†…å»ºå‡½æ•°ï¼Œå®ƒå¯ä»¥éå†æ¯ä¸ªå…ƒç´ ï¼ˆå¦‚åˆ—è¡¨ã€å…ƒç»„æˆ–å­—ç¬¦ä¸²ï¼‰ï¼Œç»„åˆä¸ºï¼šç´¢å¼•   å…ƒç´ ï¼Œå¸¸åœ¨forå¾ªç¯ä¸­ä½¿ç”¨ã€‚<br>
enumerate(åˆ—è¡¨å)</p>
<pre><code class="language-python">seq = ['one', 'two', 'three']
for i, element in enumerate(seq):
    print(i, element)

# è¿è¡Œç»“æœ
# 0 one
# 1 two
# 2 three
</code></pre>
</li>
<li>
<p>tf.one_hot</p>
<p>ç‹¬çƒ­ç¼–ç ï¼ˆone-hot encodeingï¼‰ï¼šåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå¸¸ç”¨ç‹¬çƒ­ç åšæ ‡ç­¾ï¼Œæ ‡è®°ç±»åˆ«ï¼š1è¡¨ç¤ºæ˜¯ï¼Œ0è¡¨ç¤ºéã€‚<br>
(0ç‹—å°¾è‰é¸¢å°¾   1æ‚è‰²é¸¢å°¾  2ä½›å‰å°¼äºšé¸¢å°¾)<br>
æ ‡ç­¾ï¼š     1<br>
ç‹¬çƒ­ç ï¼š(0.            1.            0.)</p>
<pre><code class="language-python">import tensorflow as tf

classes = 3
labels = tf.constant([1, 0, 2])  # è¾“å…¥çš„å…ƒç´ å€¼æœ€å°ä¸º0ï¼Œæœ€å¤§ä¸º2
output = tf.one_hot(labels, depth=classes)
print(&quot;result of labels1:&quot;, output)
print(&quot;\n&quot;)

# è¿è¡Œç»“æœ
# result of labels1: tf.Tensor(
# [[0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]], shape=(3, 3), dtype=float32)
</code></pre>
</li>
<li>
<p>tf.nn.softmax</p>
<figure data-type="image" tabindex="2"><img src="https://images.cnblogs.com/cnblogs_com/ache/1998711/o_2107111240411-2.png" alt="image-20210710144018858" loading="lazy"></figure>
<p>å½“nåˆ†ç±»çš„nä¸ªè¾“å‡º$$(y_0,y_1,...,y_{n-1})$$é€šè¿‡softmax()å‡½æ•°ï¼Œä¾¿ç¬¦åˆæ¦‚ç‡åˆ†å¸ƒäº†ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ€</mi><mi>x</mi><mi>P</mi><mo>(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo>)</mo><mo>âˆˆ</mo><mo>[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>]</mo><mi mathvariant="normal">ä¸”</mi><munder><mo>âˆ‘</mo><mi>x</mi></munder><mi>P</mi><mo>(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\forall x  P(X=x)\in[0,1]ä¸”\sum_x P(X=x)=1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ€</span><span class="mord mathdefault">x</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3000100000000003em;vertical-align:-1.250005em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord cjk_fallback">ä¸”</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<pre><code class="language-python">import tensorflow as tf

y = tf.constant([1.01, 2.01, -0.66])
y_pro = tf.nn.softmax(y)

print(&quot;After softmax, y_pro is:&quot;, y_pro)  # y_pro ç¬¦åˆæ¦‚ç‡åˆ†å¸ƒ

print(&quot;The sum of y_pro:&quot;, tf.reduce_sum(y_pro))  # é€šè¿‡softmaxåï¼Œæ‰€æœ‰æ¦‚ç‡åŠ èµ·æ¥å’Œä¸º1

# è¿è¡Œç»“æœ
# After softmax, y_pro is: tf.Tensor([0.25598174 0.69583046 0.0481878 ], shape=(3,), dtype=float32)
# The sum of y_pro: tf.Tensor(1.0, shape=(), dtype=float32)
</code></pre>
</li>
<li>
<p>assign_sub</p>
<p>èµ‹å€¼æ“ä½œï¼Œæ›´æ–°å‚æ•°çš„å€¼å¹¶è¿”å›ã€‚<br>
è°ƒç”¨assign_subå‰ï¼Œå…ˆç”¨tf.Variableå®šä¹‰å˜é‡wä¸ºå¯è®­ç»ƒ(å¯è‡ªæ›´æ–°)ã€‚<br>
w.assign_sub(wè¦è‡ªå‡çš„å†…å®¹)</p>
<pre><code class="language-python">import tensorflow as tf

x = tf.Variable(4)
x.assign_sub(1)
print(&quot;x:&quot;, x)  # 4-1=3

# è¿è¡Œç»“æœ
# x: &lt;tf.Variable 'Variable:0' shape=() dtype=int32, numpy=3&gt;
</code></pre>
</li>
<li>
<p>tf.argmax</p>
<p>è¿”å›å¼ é‡æ²¿æŒ‡å®šç»´åº¦æœ€å¤§å€¼çš„ç´¢å¼•<br>
tf.argmax(å¼ é‡å, axis=æ“ä½œè½´)</p>
<pre><code class="language-python">import numpy as np
import tensorflow as tf

test = np.array([[1, 2, 3], [2, 3, 4], [5, 4, 3], [8, 7, 2]])
print(&quot;test:\n&quot;, test)
print(&quot;æ¯ä¸€åˆ—çš„æœ€å¤§å€¼çš„ç´¢å¼•ï¼š&quot;, tf.argmax(test, axis=0))  # è¿”å›æ¯ä¸€åˆ—æœ€å¤§å€¼çš„ç´¢å¼•
print(&quot;æ¯ä¸€è¡Œçš„æœ€å¤§å€¼çš„ç´¢å¼•&quot;, tf.argmax(test, axis=1))  # è¿”å›æ¯ä¸€è¡Œæœ€å¤§å€¼çš„ç´¢å¼•

# è¿è¡Œç»“æœ
# æ¯ä¸€åˆ—çš„æœ€å¤§å€¼çš„ç´¢å¼•ï¼š tf.Tensor([3 3 1], shape=(3,), dtype=int64)
# æ¯ä¸€è¡Œçš„æœ€å¤§å€¼çš„ç´¢å¼• tf.Tensor([2 2 0 0], shape=(4,), dtype=int64)
</code></pre>
</li>
</ul>
<h3 id="15-é¸¢å°¾èŠ±æ•°æ®é›†è¯»å…¥">1.5 é¸¢å°¾èŠ±æ•°æ®é›†è¯»å…¥</h3>
<ul>
<li>
<p>æ•°æ®é›†ä»‹ç»</p>
<p>å…±æœ‰æ•°æ®150ç»„ï¼Œæ¯ç»„åŒ…æ‹¬èŠ±è¼é•¿ã€èŠ±è¼å®½ã€èŠ±ç“£é•¿ã€èŠ±ç“£å®½4ä¸ªè¾“å…¥ç‰¹å¾ã€‚åŒæ—¶ç»™å‡ºäº†ï¼Œè¿™ä¸€ç»„ç‰¹å¾å¯¹åº”çš„é¸¢å°¾èŠ±ç±»åˆ«ã€‚ç±»åˆ«åŒ…æ‹¬Setosa Irisï¼ˆç‹—å°¾è‰é¸¢å°¾ï¼‰ï¼ŒVersicolour Irisï¼ˆæ‚è‰²é¸¢å°¾ï¼‰ï¼ŒVirginica Irisï¼ˆå¼—å‰å°¼äºšé¸¢å°¾ï¼‰ä¸‰ç±»ï¼Œåˆ†åˆ«ç”¨æ•°å­—0ï¼Œ1ï¼Œ2è¡¨ç¤ºã€‚</p>
</li>
<li>
<p>ä»sklearnåŒ…datasetsè¯»å…¥æ•°æ®é›†ï¼Œè¯­æ³•ä¸ºï¼š</p>
<pre><code class="language-python">from sklearn.datasets import load_iris
x_data = datasets.load_iris().data  # è¿”å›irisæ•°æ®é›†æ‰€æœ‰è¾“å…¥ç‰¹å¾
y_data = datasets.load_iris().target  # è¿”å›irisæ•°æ®é›†æ‰€æœ‰æ ‡ç­¾
</code></pre>
</li>
<li>
<p>å®Œæ•´çš„ä»£ç </p>
<pre><code class="language-python">from sklearn import datasets
from pandas import DataFrame
import pandas as pd

x_data = datasets.load_iris().data  # .dataè¿”å›irisæ•°æ®é›†æ‰€æœ‰è¾“å…¥ç‰¹å¾
y_data = datasets.load_iris().target  # .targetè¿”å›irisæ•°æ®é›†æ‰€æœ‰æ ‡ç­¾
print(&quot;x_data from datasets: \n&quot;, x_data)
print(&quot;y_data from datasets: \n&quot;, y_data)

x_data = DataFrame(x_data, columns=['èŠ±è¼é•¿åº¦', 'èŠ±è¼å®½åº¦', 'èŠ±ç“£é•¿åº¦', 'èŠ±ç“£å®½åº¦'])  # ä¸ºè¡¨æ ¼å¢åŠ è¡Œç´¢å¼•ï¼ˆå·¦ä¾§ï¼‰å’Œåˆ—æ ‡ç­¾ï¼ˆä¸Šæ–¹ï¼‰
pd.set_option('display.unicode.east_asian_width', True)  # è®¾ç½®åˆ—åå¯¹é½
print(&quot;x_data add index: \n&quot;, x_data)

x_data['ç±»åˆ«'] = y_data  # æ–°åŠ ä¸€åˆ—ï¼Œåˆ—æ ‡ç­¾ä¸ºâ€˜ç±»åˆ«â€™ï¼Œæ•°æ®ä¸ºy_data
print(&quot;x_data add a column: \n&quot;, x_data)

#ç±»å‹ç»´åº¦ä¸ç¡®å®šæ—¶ï¼Œå»ºè®®ç”¨printå‡½æ•°æ‰“å°å‡ºæ¥ç¡®è®¤æ•ˆæœ

# è¿è¡Œç»“æœ
# x_data from datasets:
#  [[5.1 3.5 1.4 0.2]
#  [4.9 3.  1.4 0.2]
#  [4.7 3.2 1.3 0.2]
#  [4.6 3.1 1.5 0.2]
#  [5.  3.6 1.4 0.2]
#  ... ...
# y_data from datasets:
#  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#  0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
#  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
#  2 2]
#
# x_data add a column: 
#       èŠ±è¼é•¿åº¦  èŠ±è¼å®½åº¦  èŠ±ç“£é•¿åº¦  èŠ±ç“£å®½åº¦  ç±»åˆ«
# 0         5.1       3.5       1.4       0.2     0
# 1         4.9       3.0       1.4       0.2     0
# 2         4.7       3.2       1.3       0.2     0
# 3         4.6       3.1       1.5       0.2     0
# 4         5.0       3.6       1.4       0.2     0
# ..        ...       ...       ...       ...   ...
# 145       6.7       3.0       5.2       2.3     2
# 146       6.3       2.5       5.0       1.9     2
# 147       6.5       3.0       5.2       2.0     2
# 148       6.2       3.4       5.4       2.3     2
# 149       5.9       3.0       5.1       1.8     2
#
# [150 rows x 5 columns]
</code></pre>
</li>
</ul>
<h3 id="16-ç¥ç»ç½‘ç»œå®ç°é¸¢å°¾èŠ±åˆ†ç±»">1.6 ç¥ç»ç½‘ç»œå®ç°é¸¢å°¾èŠ±åˆ†ç±»</h3>
<ol>
<li>å‡†å¤‡æ•°æ®</li>
</ol>
<ul>
<li>æ•°æ®é›†è¯»å…¥</li>
<li>æ•°æ®é›†ä¹±åº</li>
<li>ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›† (å³x_train / y_train, x_test / y_test)</li>
<li>é…æˆï¼ˆè¾“å…¥ç‰¹å¾ï¼Œæ ‡ç­¾ï¼‰å¯¹ï¼Œæ¯æ¬¡è¯»å…¥ä¸€å°æ’®ï¼ˆbatchï¼‰</li>
</ul>
<ol start="2">
<li>æ­å»ºç½‘ç»œ
<ul>
<li>å®šä¹‰ç¥ç»ç½‘ç»œä¸­æ‰€æœ‰å¯è®­ç»ƒå‚æ•°</li>
</ul>
</li>
<li>å‚æ•°ä¼˜åŒ–
<ul>
<li>åµŒå¥—å¾ªç¯è¿­ä»£ï¼Œwithç»“æ„æ›´æ–°å‚æ•°ï¼Œæ˜¾ç¤ºå½“å‰loss</li>
</ul>
</li>
<li>æµ‹è¯•æ•ˆæœ
<ul>
<li>è®¡ç®—å½“å‰å‚æ•°å‰å‘ä¼ æ’­åçš„å‡†ç¡®ç‡ï¼Œæ˜¾ç¤ºå½“å‰acc</li>
</ul>
</li>
<li>acc / loss å¯è§†åŒ–</li>
</ol>
<pre><code class="language-python"># -*- coding: UTF-8 -*-
# åˆ©ç”¨é¸¢å°¾èŠ±æ•°æ®é›†ï¼Œå®ç°å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­ï¼Œå¯è§†åŒ–lossæ›²çº¿

# å¯¼å…¥æ‰€éœ€æ¨¡å—
import tensorflow as tf
from sklearn import datasets
from matplotlib import pyplot as plt
import numpy as np

# å¯¼å…¥æ•°æ®ï¼Œåˆ†åˆ«ä¸ºè¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾
x_data = datasets.load_iris().data
y_data = datasets.load_iris().target

# éšæœºæ‰“ä¹±æ•°æ®ï¼ˆå› ä¸ºåŸå§‹æ•°æ®æ˜¯é¡ºåºçš„ï¼Œé¡ºåºä¸æ‰“ä¹±ä¼šå½±å“å‡†ç¡®ç‡ï¼‰
# seed: éšæœºæ•°ç§å­ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå½“è®¾ç½®ä¹‹åï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°éƒ½ä¸€æ ·ï¼ˆä¸ºæ–¹ä¾¿æ•™å­¦ï¼Œä»¥ä¿æ¯ä½åŒå­¦ç»“æœä¸€è‡´ï¼‰
np.random.seed(116)  # ä½¿ç”¨ç›¸åŒçš„seedï¼Œä¿è¯è¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾ä¸€ä¸€å¯¹åº”
np.random.shuffle(x_data)
np.random.seed(116)
np.random.shuffle(y_data)
tf.random.set_seed(116)

# å°†æ‰“ä¹±åçš„æ•°æ®é›†åˆ†å‰²ä¸ºæ°¸ä¸ç›¸è§çš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œè®­ç»ƒé›†ä¸ºå‰120è¡Œï¼Œæµ‹è¯•é›†ä¸ºå30è¡Œ
x_train = x_data[:-30]
y_train = y_data[:-30]
x_test = x_data[-30:]
y_test = y_data[-30:]

# è½¬æ¢xçš„æ•°æ®ç±»å‹ï¼Œå¦åˆ™åé¢çŸ©é˜µç›¸ä¹˜æ—¶ä¼šå› æ•°æ®ç±»å‹ä¸ä¸€è‡´æŠ¥é”™
x_train = tf.cast(x_train, tf.float32)
x_test = tf.cast(x_test, tf.float32)

# from_tensor_sliceså‡½æ•°ä½¿è¾“å…¥ç‰¹å¾å’Œæ ‡ç­¾å€¼ä¸€ä¸€å¯¹åº”ã€‚ï¼ˆæŠŠæ•°æ®é›†åˆ†æ‰¹æ¬¡ï¼Œæ¯ä¸ªæ‰¹æ¬¡batchç»„æ•°æ®ï¼‰
train_db = tf.data.Dataset.from_tensor_slices((x_train, y_train)).batch(32)
test_db = tf.data.Dataset.from_tensor_slices((x_test, y_test)).batch(32)

# ç”Ÿæˆç¥ç»ç½‘ç»œçš„å‚æ•°ï¼Œ4ä¸ªè¾“å…¥ç‰¹å¾æ•…ï¼Œè¾“å…¥å±‚ä¸º4ä¸ªè¾“å…¥èŠ‚ç‚¹ï¼›å› ä¸º3åˆ†ç±»ï¼Œæ•…è¾“å‡ºå±‚ä¸º3ä¸ªç¥ç»å…ƒ
# ç”¨tf.Variable()æ ‡è®°å‚æ•°å¯è®­ç»ƒ
# ä½¿ç”¨seedä½¿æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒï¼ˆæ–¹ä¾¿æ•™å­¦ï¼Œä½¿å¤§å®¶ç»“æœéƒ½ä¸€è‡´ï¼Œåœ¨ç°å®ä½¿ç”¨æ—¶ä¸å†™seedï¼‰
w1 = tf.Variable(tf.random.truncated_normal([4, 3], stddev=0.1, seed=1))
b1 = tf.Variable(tf.random.truncated_normal([3], stddev=0.1, seed=1))

lr = 0.1  # å­¦ä¹ ç‡ä¸º0.1
train_loss_results = []  # å°†æ¯è½®çš„lossè®°å½•åœ¨æ­¤åˆ—è¡¨ä¸­ï¼Œä¸ºåç»­ç”»lossæ›²çº¿æä¾›æ•°æ®
test_acc = []  # å°†æ¯è½®çš„accè®°å½•åœ¨æ­¤åˆ—è¡¨ä¸­ï¼Œä¸ºåç»­ç”»accæ›²çº¿æä¾›æ•°æ®
epoch = 500  # å¾ªç¯500è½®
loss_all = 0  # æ¯è½®åˆ†4ä¸ªstepï¼Œloss_allè®°å½•å››ä¸ªstepç”Ÿæˆçš„4ä¸ªlossçš„å’Œ

# è®­ç»ƒéƒ¨åˆ†
for epoch in range(epoch):  #æ•°æ®é›†çº§åˆ«çš„å¾ªç¯ï¼Œæ¯ä¸ªepochå¾ªç¯ä¸€æ¬¡æ•°æ®é›†
    for step, (x_train, y_train) in enumerate(train_db):  #batchçº§åˆ«çš„å¾ªç¯ ï¼Œæ¯ä¸ªstepå¾ªç¯ä¸€ä¸ªbatch
        with tf.GradientTape() as tape:  # withç»“æ„è®°å½•æ¢¯åº¦ä¿¡æ¯
            y = tf.matmul(x_train, w1) + b1  # ç¥ç»ç½‘ç»œä¹˜åŠ è¿ç®—
            y = tf.nn.softmax(y)  # ä½¿è¾“å‡ºyç¬¦åˆæ¦‚ç‡åˆ†å¸ƒï¼ˆæ­¤æ“ä½œåä¸ç‹¬çƒ­ç åŒé‡çº§ï¼Œå¯ç›¸å‡æ±‚lossï¼‰
            y_ = tf.one_hot(y_train, depth=3)  # å°†æ ‡ç­¾å€¼è½¬æ¢ä¸ºç‹¬çƒ­ç æ ¼å¼ï¼Œæ–¹ä¾¿è®¡ç®—losså’Œaccuracy
            loss = tf.reduce_mean(tf.square(y_ - y))  # é‡‡ç”¨å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°mse = mean(sum(y-out)^2)
            loss_all += loss.numpy()  # å°†æ¯ä¸ªstepè®¡ç®—å‡ºçš„lossç´¯åŠ ï¼Œä¸ºåç»­æ±‚losså¹³å‡å€¼æä¾›æ•°æ®ï¼Œè¿™æ ·è®¡ç®—çš„lossæ›´å‡†ç¡®
        # è®¡ç®—losså¯¹å„ä¸ªå‚æ•°çš„æ¢¯åº¦
        grads = tape.gradient(loss, [w1, b1])

        # å®ç°æ¢¯åº¦æ›´æ–° w1 = w1 - lr * w1_grad    b = b - lr * b_grad
        w1.assign_sub(lr * grads[0])  # å‚æ•°w1è‡ªæ›´æ–°
        b1.assign_sub(lr * grads[1])  # å‚æ•°bè‡ªæ›´æ–°

    # æ¯ä¸ªepochï¼Œæ‰“å°lossä¿¡æ¯
    print(&quot;Epoch {}, loss: {}&quot;.format(epoch, loss_all/4))
    train_loss_results.append(loss_all / 4)  # å°†4ä¸ªstepçš„lossæ±‚å¹³å‡è®°å½•åœ¨æ­¤å˜é‡ä¸­
    loss_all = 0  # loss_allå½’é›¶ï¼Œä¸ºè®°å½•ä¸‹ä¸€ä¸ªepochçš„lossåšå‡†å¤‡

    # æµ‹è¯•éƒ¨åˆ†
    # total_correctä¸ºé¢„æµ‹å¯¹çš„æ ·æœ¬ä¸ªæ•°, total_numberä¸ºæµ‹è¯•çš„æ€»æ ·æœ¬æ•°ï¼Œå°†è¿™ä¸¤ä¸ªå˜é‡éƒ½åˆå§‹åŒ–ä¸º0
    total_correct, total_number = 0, 0
    for x_test, y_test in test_db:
        # ä½¿ç”¨æ›´æ–°åçš„å‚æ•°è¿›è¡Œé¢„æµ‹
        y = tf.matmul(x_test, w1) + b1
        y = tf.nn.softmax(y)
        pred = tf.argmax(y, axis=1)  # è¿”å›yä¸­æœ€å¤§å€¼çš„ç´¢å¼•ï¼Œå³é¢„æµ‹çš„åˆ†ç±»
        # å°†predè½¬æ¢ä¸ºy_testçš„æ•°æ®ç±»å‹
        pred = tf.cast(pred, dtype=y_test.dtype)
        # è‹¥åˆ†ç±»æ­£ç¡®ï¼Œåˆ™correct=1ï¼Œå¦åˆ™ä¸º0ï¼Œå°†boolå‹çš„ç»“æœè½¬æ¢ä¸ºintå‹
        correct = tf.cast(tf.equal(pred, y_test), dtype=tf.int32)
        # å°†æ¯ä¸ªbatchçš„correctæ•°åŠ èµ·æ¥
        correct = tf.reduce_sum(correct)
        # å°†æ‰€æœ‰batchä¸­çš„correctæ•°åŠ èµ·æ¥
        total_correct += int(correct)
        # total_numberä¸ºæµ‹è¯•çš„æ€»æ ·æœ¬æ•°ï¼Œä¹Ÿå°±æ˜¯x_testçš„è¡Œæ•°ï¼Œshape[0]è¿”å›å˜é‡çš„è¡Œæ•°
        total_number += x_test.shape[0]
    # æ€»çš„å‡†ç¡®ç‡ç­‰äºtotal_correct/total_number
    acc = total_correct / total_number
    test_acc.append(acc)
    print(&quot;Test_acc:&quot;, acc)
    print(&quot;--------------------------&quot;)

# ç»˜åˆ¶ loss æ›²çº¿
plt.title('Loss Function Curve')  # å›¾ç‰‡æ ‡é¢˜
plt.xlabel('Epoch')  # xè½´å˜é‡åç§°
plt.ylabel('Loss')  # yè½´å˜é‡åç§°
plt.plot(train_loss_results, label=&quot;$Loss$&quot;)  # é€ç‚¹ç”»å‡ºtrian_loss_resultså€¼å¹¶è¿çº¿ï¼Œè¿çº¿å›¾æ ‡æ˜¯Loss
plt.legend()  # ç”»å‡ºæ›²çº¿å›¾æ ‡
plt.show()  # ç”»å‡ºå›¾åƒ

# ç»˜åˆ¶ Accuracy æ›²çº¿
plt.title('Acc Curve')  # å›¾ç‰‡æ ‡é¢˜
plt.xlabel('Epoch')  # xè½´å˜é‡åç§°
plt.ylabel('Acc')  # yè½´å˜é‡åç§°
plt.plot(test_acc, label=&quot;$Accuracy$&quot;)  # é€ç‚¹ç”»å‡ºtest_accå€¼å¹¶è¿çº¿ï¼Œè¿çº¿å›¾æ ‡æ˜¯Accuracy
plt.legend()
plt.show()

# è¿è¡Œç»“æœ
# --------------------------
# Epoch 498, loss: 0.03232626663520932
# Test_acc: 1.0
# --------------------------
# Epoch 499, loss: 0.032300274819135666
# Test_acc: 1.0
# --------------------------
</code></pre>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://perfectqing.github.io/blogs/tag/S2mqBZ0HP/" class="tag">
                    TensorFlow ç¬”è®°
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://perfectqing.github.io/blogs/post/Deep Reinforcement Learning in a Handful of Trials using Probabilistic Dynamics Models/">
                  <h3 class="post-title">
                    Deep Reinforcement Learning in a Handful of Trials using Probabilistic Dynamics Models
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
